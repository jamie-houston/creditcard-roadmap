{% extends "base.html" %} {% block title %}Reward Categories - {{ super() }}{%
endblock %} {% block content %}
<div class="container py-4">
  <h1 class="mb-4">
    <i class="fas fa-tags me-2"></i>Credit Card Reward Categories
  </h1>

  <!-- Flash messages -->
  {% with messages = get_flashed_messages(with_categories=true) %} {% if
  messages %} {% for category, message in messages %}
  <div
    class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show"
    role="alert"
  >
    {{ message }}
    <button
      type="button"
      class="btn-close"
      data-bs-dismiss="alert"
      aria-label="Close"
    ></button>
  </div>
  {% endfor %} {% endif %} {% endwith %}

  <!-- Info Banner -->
  <div class="card mb-4 bg-light">
    <div class="card-body">
      <div class="d-flex align-items-center">
        <div class="me-3">
          <i class="fas fa-info-circle fa-2x text-info"></i>
        </div>
        <div>
          <h5 class="mb-1">Understanding Reward Categories</h5>
          <p class="mb-0">
            Credit cards offer different reward rates based on spending
            categories. Click on any category below to see which credit cards
            offer the best rewards for that category.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Categories Grid -->
  <div class="row row-cols-1 row-cols-md-3 g-4">
    {% for category in categories %}
    <div class="col">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <div class="d-flex align-items-center mb-3">
            <div class="category-icon me-3">
              <i class="{{ category.icon }} fa-2x text-primary"></i>
            </div>
            <h5 class="card-title mb-0">{{ category.display_name }}</h5>
          </div>
          {% if category.description %}
          <p class="card-text text-muted">{{ category.description }}</p>
          {% else %}
          <p class="card-text text-muted font-italic">
            No description available
          </p>
          {% endif %}

          <!-- Card count with this category -->
          {% set card_count = category.card_rewards.count() %}
          <div class="mt-3">
            <span class="badge bg-primary"
              >{{ card_count }} card{{ 's' if card_count != 1 }}</span
            >
            {% if card_count > 0 %} {% set best_reward =
            category.card_rewards.order_by(category.card_rewards.c.reward_percent.desc()).first()
            %} {% if best_reward %}
            <span class="badge bg-success"
              >Up to {{ best_reward.reward_percent }}%</span
            >
            {% endif %} {% endif %}
          </div>
        </div>
        <div class="card-footer bg-transparent border-top-0">
          <a
            href="{{ url_for('categories.show', id=category.id) }}"
            class="btn btn-outline-primary btn-sm stretched-link"
          >
            <i class="fas fa-search"></i> View Details
          </a>
        </div>
      </div>
    </div>
    {% else %}
    <div class="col-12">
      <div class="text-center py-5">
        <i class="fas fa-tags fa-3x text-muted mb-3"></i>
        <h4>No Categories Found</h4>
        <p class="text-muted">No reward categories are currently available.</p>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endblock %}
